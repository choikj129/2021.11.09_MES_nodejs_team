<!DOCTYPE html>
<html>
    <head>
        <%- include("./head.ejs") %>
        <link rel = "stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" />
        <script src = "http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src = "http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
	      <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <style>
        
          .table{
            width: 70em;
            text-align: center;
            background-color: rgb(173, 185, 202);
          }
          .input-group{
            width: 20rem;
            text-align: center;
            background-color: rgb(173, 185, 202);
          } 
          .wrapper{
            height:11rem;
            width:70em;
            background-color: rgba(199, 202, 241, 0.308);
          }
          #instruct_icon{
            background-color: var(--first-color);
          }
          .input-group-text{
            border-radius:0
          }
          .form-control{
            border-radius: 0;
          }
          
        </style>
    </head>

    <body style="background-color: rgb(41, 48, 63);">
      <form action="/instruct" method="POST">
        <div class="wrapper" style="position: absolute; left:15%">
          <div class="input-group mb-3" style="position: absolute; left:15%; top:10%">
            <span class="input-group-text" id="inputGroup-sizing-default">담당자</span>
            <input type="text" class="form-control" placeholder="담당자" id = "manager" name="_manager">
          </div>
          <div class="input-group mb-3" style="position: absolute; left:55%; top:10%">
            <span class="input-group-text" id="inputGroup-sizing-default">지시 수량</span>
            <input type="text" class="form-control" placeholder="지시 수량" id = "quantity" name="_quantity">
          </div>
          <div class="input-group mb-3" style="position: absolute; left:15%; top:40%">
            <label class="input-group-text" for="inputGroupSelect01">품목 번호</label>
            <select class="form-select" id="inputGroupSelect01" name ="_id">
              <option value="bricks_rect">bricks_rect</option>
              <option value="bricks_square">bricks_square</option>
              <option value="circle">circle</option>
              <option value="floor">floor</option>
            </select>
          </div>
          <div class="input-group mb-3" style="position: absolute; left:55%; top:40%">
            <label class="input-group-text" for="inputGroupSelect01">작업 날짜</label>
            <input type = "text" id = "testDatepicker" name="_date" value="<%= date %> ">
          </div>
          <div align="center">
            <button type="submit" class="btn btn-dark" id = "register" disabled>등록</button>
          </div>
        </div>
        
      </form>
      
      <div style="position: absolute; top:13.5em; left:15%; color:white; text-align: center;">
        <table class = "table table-bordered" style=" text-align: center; color:white; background-color: rgba(95, 100, 126, 0.699);">
          <thead style="background-color: rgba(199, 202, 241, 0.308); height:3em;">
            <tr>
              <th scope="col" style="width: 11em;">작업지시번호</th>
              <th scope="col" style="width: 11em;">품목명</th>
              <th scope="col" style="width: 7em;">지시 수량</th>
              <th scope="col" style="width: 20em;">작업 날짜</th>
              <th scope="col" style="width: 10em;">상태</th>
              <th scope="col" style="width: 5vw;">비고</th>
              
            </tr>
          </thead>
          <tbody>
            
            <% for(var i=0; i < ordert.length; i++) {%>
              <tr>
                <td><%=ordert[i].order_id%></td>
                <td><%=ordert[i].lego_id%></td>
                <td><%=ordert[i].quantity%></td>
                <td><%=ordert[i].date%></td>
                <td>진행중</td>
                <td style="padding: 3px;"><button style="height: 5vh;"type="submit" class="btn btn-danger " onclick="del('<%=ordert[i].order_id%>')">삭제</button></td>
              </tr>
            <%}%>
          </tbody>
        </table>
      </div>
      
      <script>
        $(function(){
          $("#testDatepicker").datepicker({
            showButtonPanel : true,
            currentText : '오늘 날짜',
            closeText: '닫기',
            dateFormat : "yy-mm-dd",
            monthNames : ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'],
            monthNamesShort : ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'],
            dayNames : ['월요일', '화요일', '수요일', '목요일', '금요일', '토요일', '이유일'],
            dayNamesMin : ['월','화','수','목','금','토','일'],
            changeMonth : true,
            changeYear : true,
            nextText : '다음달',
            prevText : '이전달'
            
          });
        });

        $("input").keyup(function(){
          var manager = $("#manager").val();
          var quantity = $("#quantity").val();
          var date = $("#testDatepicker").val();
          
          if(manager && quantity && date){    
              $("#register").removeAttr("disabled")
          }else{
              $("#register").attr("disabled", "disabled")
            }
        })
        function del(id){
          if(confirm("삭제 하시겠습니까?")) {
            alert("삭제되었습니다.");
            location.href="/del?_id="+id
          }
          
        }
        
        
      </script>
    </body>
</html>
